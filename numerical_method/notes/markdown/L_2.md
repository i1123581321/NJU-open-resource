[![white.png](https://i.loli.net/2019/04/11/5cae134487910.png)](https://github.com/i1123581321/NJU-open-resource)

# 线性方程组的直接解法

## 线性方程组直接解法

线性方程组可使用矩阵表示为
$$
Ax = b
$$
若矩阵非奇异，即
$$
\det(A) \neq 0
$$
则方程组有唯一解。克莱姆法则计算量过大（$(n^2-1)n!$），需要构造出适合计算机使用的求解线性方程组的方法

解线性方程组的直接法即不计舍入误差，通过有限次算术运算求得精确解，适用于低阶稠密方程组。除此之外还有迭代法，通过设计迭代公式，产生逼近精确解的近似序列，迭代法适用于大型稀疏方程组

## Gauss 消去

### 基本思想

Gauss 消去的基本思想即是通过逐次消元将线性方程组转化成等价的上三角方程组。由消元和回代两个过程组成。即将原方程消去成如下形式
$$
\begin{align}
a_{11}x_1 + a_{12}x_2 + \dots+a_{1n}x_n &= b_1\\
a_{22}x_2 + \dots + a_{2n}x_n &= b_2\\
\dots &= \dots\\
a_{nn}x_n &=b_n
\end{align}
$$
然后再回代求解，要求主对角元素均不为 0

### 顺序 Gauss 消去

第一步，设 $a_{11} \neq 0$ ，矩阵为 $[A^{(1)},b^{(1)}]$，将第一列中 $a_{11}^{(1)}$ 之下的元素均消为 0，即依次用
$$
-l_{i1} = -\frac{a_{i1}^{(1)}}{a_{11}^{(1)}} \quad i = 2, 3, \dots n
$$
乘以第 1 行再加到第 $i$ 行，得到矩阵 $[A^{(2)}, b^{(2)}]$

之后每一步以此类推，对于第 $k$ 步，将第 $k$ 列中 $a_{kk}^{(k)}$ 以下的元素均消为 0，即
$$
a_{ij}^{(k+1)} = a_{ij}^{(k)} - l_{ik}a_{kj}^{(k)}\quad i,j = k+1, k+2, \dots, n\\
b_i^{(k+1)} = b_i^{(k)} - l_{ik}b_k^{(k)} \quad i = k+1, k+2, \dots, n
$$
其中
$$
l_{ik} = \frac{a_{ik}^{(k)}}{a_{kk}^{(k)}}
$$
最终得到 $[A^{(n)}, b^{(n)}]$ ，然后进行回代求解
$$
\begin{align}
x_n &= \frac{b_n^{(n)}}{a_{nn}^{(n)}}\\
x_i &= \frac{1}{a_{ii}^{(i)}}\left(b_i^{(i)} - \sum_{j = i + 1}^{n}a_{ij}^{(j)}x_j \right) \quad i = n-1, n-2, \dots ,1
\end{align}
$$
顺序 Gauss 消去要求所有主对角元不为 0，即 $a_{ii}^{(i)} \neq 0, i = 1, 2, \dots, n$ 

>约化的主元素 $a_{ii}^{(i)} \neq 0 \iff D_i \neq 0, i = 1, 2, \dots ,n$ ，其中 $D_i$ 为**顺序主子式**，并且有
>$$
>\begin{align*}
>\left\{\begin{array}{l}{a_{11}^{(1)}=D_{1}} \\ {a_{k k}^{(k)}=D_{k} / D_{k-1} \quad(k=2,3, \cdots, n)}\end{array}\right.
>\end{align*}
>$$

顺序 Gauss 的运算量大约为 $\frac{1}{3}(n^3 + 3n^2 - n)$ 。

若 $a_{kk}^{(k)} \neq 0$ ，可通过 Gauss 消去法将原方程化为等价的三角方程

若 $\det(A) \neq 0$ ，可通过 Gauss 消去和**行交换的初等变换**将原方程化为等价的三角方程

### 列主元的 Gauss 消去

顺序 Gauss 消去中 $a_{kk}^{(k)}$ 称为主元素，在第 $k$ 步消元时主元素作为分母，此时可能会有以下几种情况

* $a_{kk}^{(k)} = 0$ ，消元过程不能继续
* $|a_{kk}^{(k)}|$ 过小，作为分母会导致舍入误差过大，精度下降

为了避免这种情况，可将原方程等价变换，再用顺序消去法求解，即是列主元 Gauss 消去

列主元的步骤为在第 $i$ 步消元时，选择主元
$$
|a_{ki}^{(i)}| = \max_{i \leqslant j \leqslant n}|a_{ji}^{(i)}|
$$
然后交换第 $k$ 行和第 $i$ 行
$$
a_{kj}^{(i)} \leftrightarrow a_{ij}^{(i)} \quad j = i, i+1, \dots, n\\
b_{k}^{(i)} \leftrightarrow b_{i}^{(i)}
$$
之后同正常的消元过程一样消元即可

只要 $\det(A) \neq 0$ ，列主元 Gauss 消去即可完成

### Gauss-Jordan 消去

Gauss-Jordan 的消去过程中，第 $k$ 步消去时，将第 $k$ 列除 $a_{kk}^{(k)}$ 的元素均变为 0，即
$$
a_{ij}^{(k+1)} = a_{ij}^{(k)} - l_{ik}a_{kj}^{(k)}\quad 
\begin{cases}
i = 1, 2, \dots, k-1, k+1, \dots, n\\
j = k+1, k+2, \dots, n 
\end{cases}
\\
b_i^{(k+1)} = b_i^{(k)} - l_{ik}b_k^{(k)} \quad i = k+1, k+2, \dots, n
$$
Gauss-Jordan 消去的代价高于 Gauss 消去，最终得到一个对角阵，这种方法便于计算多个系数相同的方程组，也可以用来求矩阵的逆

## 直接三角分解法

### Gauss 消去的矩阵运算

Gauss 消去中每一步运算等价于左乘一个矩阵，如第一步消去等价于左乘矩阵
$$
\begin{align*}
L_{1}=\left[
\begin{array}{ccccc}{1} & {} & {} & {} & {} \\ 
{-l_{21}} & {1} & {} & {} & {} \\ 
{-l_{31}} & {0} & {1} & {} & {} \\ 
{\vdots} & {\vdots} & {\vdots} & {\ddots} & {} \\ 
{-l_{n 1}} & {0} & {0} & {\cdots} & {1}
\end{array}\right]
\end{align*}
$$
同理，第二步得到
$$
\begin{align*}
L_{2}=\left[
\begin{array}{ccccc}{1} & {} & {} & {} & {} \\ 
{0} & {1} & {} & {} & {} \\ 
{0} & {-l_{32}} & {1} & {} & {} \\ 
{\vdots} & {\vdots} & {\vdots} & {\ddots} & {} \\ 
{0} & {-l_{n2}} & {0} & {\cdots} & {1}
\end{array}\right]
\end{align*}
$$
依此类推，即
$$
A^{(n)} =L_{n-1} \dots L_2L_1A\\
A = L_1^{-1}L_2^{-1}\dots L_{n-1}^{-1} A^{(n)}
$$
令
$$
L = L_1^{-1}L_2^{-1}\dots L_{n-1}^{-1}
$$
则
$$
\begin{align*}
L=\left[
\begin{array}{ccccc}{1} & {} & {} & {} & {} \\ 
{-l_{21}} & {1} & {} & {} & {} \\ 
{-l_{31}} & {-l_{32}} & {1} & {} & {} \\ 
{\vdots} & {\vdots} & {\vdots} & {\ddots} & {} \\ 
{-l_{n1}} & {-l_{n2}} & {-l_{n3}} & {\cdots} & {1}
\end{array}\right]
\end{align*}
$$
则系数矩阵 $A$ 可分解为一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U(A^{(n)})$ 的乘积
$$
U = A^{(n)} = \begin{align*}
\left[\begin{array}{cccc}
{a_{11}^{(1)}} & {a_{12}^{(1)}} & {\cdots} & {a_{1 n}^{(1)}} \\ 
{} & {a_{22}^{(2)}} & {\cdots} & {a_{2 n}^{(2)}} \\ 
{} & {} & {\ddots} & {\vdots} \\ 
{} & {} & {} & {a_{n n}^{(n)}}\end{array}\right]
\end{align*}
$$
将 $A = LU$ 称为矩阵的三角分解，此时方程组为
$$
Ax = b \Rightarrow LUx = b
$$
令
$$
Ux = y
$$
则有
$$
\begin{cases}
Ly = b\\
Ux = y
\end{cases}
$$
两个方程均易求解。

对于 $Ly = b$
$$
\begin{align}
y_1 &= b1\\
y_k &= b_k - \sum_{i = 1}^{k-1}l_{ki}y_i \quad k = 2, 3, \dots, n
\end{align}
$$
对于 $Ux = y$
$$
\begin{align}
x_n &= \frac{y_n}{u_{nn}}\\
x_i &= \frac{1}{u_{ii}}\left(y_i - \sum_{j = i + 1}^{n}u_{ij}x_j \right) \quad i = n-1, n-2, \dots ,1
\end{align}
$$
系数矩阵的三角分解很关键

### Doolittle 分解

若顺序 Gauss 消去法每一步主元均不为 0，则矩阵 $A$ 可分解为 $A = LU$ ，且 $L$ 为**单位下三角矩阵**，$U$ 为上三角矩阵，这样的分解称为 Doolittle 分解

若 $A$ 的各阶顺序主子式不为 0，则存在唯一的 Doolittle 分解，可按如下公式进行
$$
\begin{align}
u_{1j} &= a_{{1j}} \quad j = 1, 2, \dots, n\\
l_{i1} &= \frac{a_{i1}}{u_{11}} \quad i = 2, 3, \dots, n \\
\end{align}
$$
对于 $i = 2, 3, \dots, n$
$$
u_{ij} = a_{ij} - \sum_{k=1}^{i - 1}l_{ik}u_{kj} \quad j = i, i+1, \dots, n
$$
对于 $j = 2, 3, \dots ,n$
$$
l_{ij} = \frac{1}{u_{jj}}\left(a_{ij} - \sum_{k=1}^{j-1}l_{ik}u_{kj} \right) \quad i = j+1, j+2, \dots, n
$$
这样的分解过程叫做 Doolittle 分解。

存储时为了方便可以将 $L, U$ 存储在同一矩阵