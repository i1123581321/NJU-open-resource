# 00

On Java 8 第四章和第五章的阅读笔记，主要内容是 Java 语言的基础

## 运算符

大部分运算符只能操作基本类型，`=`、`==`、`!=` 可以对所有对象使用

String 支持 `+` 和 `+=`，如果一个表达式以 String 开头，则之后的所有运算对象都是 String

基本类型的赋值是直接赋值，对象的赋值只是对引用的赋值（方法调用参数也是传引用）

Java 有 8 种基本类型

* 整型，包括 `byte`，`short`，`int`，`long`
* 浮点，包括 `float`，`double`
* 布尔 `boolean`
* 字符 `char`

### 算数运算符

二元算术运算符同 C，同样有和 `=` 结合的用法

一元减号得到数据的负值，一元加号不改变数据的值，且可以将较小的数值类型转换为 int

前缀和后缀的递增/递减同 C

### 关系运算符与逻辑运算符

`==` 和 `!=` 可以用于所有基本类型，大于/小于等比较运算符不能用于 boolean

等于和不等于也可以用于判断对象，但是比较的是**对象的引用**，想要得到正确的结果要用对象的 `equals()` 方法，但是 `equals()` 默认比较引用，所以自定义类要重载

Java 中与或非仅能用于布尔值

逻辑运算符支持短路

还有唯一的三元运算符 `?:`，用法同 C

### 字面量

字面量类似 C，用 `0x` 作为十六进制前缀，前导零作为八进制前缀，`0b` 作为二进制前缀，`L` 为 long 的后缀，`f` 为 float 后缀

可以在字面量中加入下划线辅助阅读

也有指数计数法，如 `1.36E-43`

### 位运算符与移位运算符

包括按位与或非和异或

只能操作整数和布尔值，布尔值按照单比特操作，但是只能执行与或和异或（不能对布尔值执行按位非，以避免和逻辑非混淆）。对于布尔值，位操作和逻辑操作结果相同，但是没有短路现象

移位只能操作整数（不能操作布尔值）

Java 提供了算数左右移和逻辑右移 `>>>`，逻辑右移不论符号在高位补 0

对短于 int 的值移位会将其提升至 int

> 但是，问题来了，当无符号右移与赋值相结合时，若将其与 **byte** 或 **short** 一起使用的话，则结果错误。取而代之的是，它们被提升为 **int** 型并右移，但在重新赋值时被截断。在这种情况下，结果为 -1。

## 类型转换

向上转换可以隐式进行，因为不会有信息的丢失，而向下转换需要显式地声明，同 C

除了布尔类型以以外，其余基本类型可以互相转换

类不能类型转换

向下转换时都会截断，需要舍入则使用 `Math.round()`

而对短于 int 的类型计算时会向上提升至 int，且结果为 int。通常表达式中最大的类型决定结果的类型

更多关于类型的知识参见 [On Java 8 chapter 04]( https://lingcoder.github.io/OnJava8/#/book/04-Operators)

## 控制流

Java 的控制流与 C 十分相似，关键字包括 `if-else`，`while`，`do-while`，`for`，`return`，`break`，`continue`

Java 同样有 `switch` 关键字

控制流的结果依赖于条件表达式的值，任何关系运算符都能产生条件表达式，但是不能将数值作为条件表达式

逗号运算符可以在 for 循环的初始化和步进部分定义多个变量

```Java
for(int i = 1, j = i + 10; i < 5; i++, j = i * 2) {
    System.out.println("i = " + i + " j = " + j);
}
```

在 Java 5 引入了 `for-in` 语法，用于在不创建变量和设置步进的情况下遍历集合，`for-in` 适用于所有可迭代对象。

返回值为 void 的函数会隐式 return，但是如果返回值有类型则必须显式 return

`break/continue` 用于控制循环流程，也可以在其之后跟着标号以实现 goto 型的跳转，一般用于跳出迭代循环的外层

switch 同样是控制语句，且其因子只能是整数或 String，但是可以通过枚举类型扩展 switch 的功能

